<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>Kitsune</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<link rel="stylesheet" href="/css/index.css">

		<script src="/js/request-scan.js"></script>

		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">

		<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
		<script src="./js/babylon-viewer.js"></script>

		<!-- MDB -->
		<link
				href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.6.0/mdb.min.css"
				rel="stylesheet"
		/>

		<script
				type="text/javascript"
				src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.6.0/mdb.min.js"
		></script>

	</head>
	<body style="background-color: #add8e6;">
		<section>
			<br>
			<div class="d-flex justify-content-center">
				<h1 id="kit">KITSUNE</h1>
			</div>
		</section>
		
		
		<section>
			<form id="form_post" action="/start_scan" method="POST">
				<div class="ml-5 float-left componentWrapper" style="background-color: white; border-color: black;">
					<div class="componentWrapper" style="border-color: blue;">
						<p class="componentTitle">Informaci칩n General</p>
						<div id="generic_data">

								<label for="urlToScan">URL a escanear:</label>
								<input type="text" name="urlToScan" id="urlToScan"><br>
								<div class="custom-control custom-checkbox">
									<input type="checkbox" class="custom-control-input" id="scanAll" name="scanAll" checked>
									<label class="custom-control-label" for="scanAll">Explorar el sitio web completo</label>
								</div>
								<label for="user">Usuario:</label>
								<input type="text" name="user" id="user"><br>
								<label for="password">Contrase침a:</label>
								<input type="password" name="password" id="password"><br>
							<button onclick="requestScan()">Iniciar scan</button>
						</div>
					</div>
					<div class="d-flex justify-content-center">
						<canvas id="renderCanvas" style="height: 350px; width: 350px;"></canvas>
					</div>
				</div>

				<div class="componentWrapper w-50 mr-5 float-right" style="background-color: white;">
					<div class="componentWrapper" style="border-color: blue">
						<p class="componentTitle">An치lisis de vulnerabilidades</p>
						<div class="clearfix">
							<div class="float-left w-75">
								<button class="btn btn-primary btn-block float-left" type="button" data-toggle="collapse" data-target="#xss-options">
									XSS
								</button>
							</div>
							<div class="float-left">
								<button type="button" class="btn btn-dark btn-sm btn-floating float-left" style="margin-top: 5px; margin-left: 15px;" onclick="location.href='/xss_help.html'">
									<i class="fas fa-question"></i>
								</button>
							</div>
							<div class="custom-control custom-checkbox float-right" style="margin-top: 5px;">
								<input type="checkbox" class="custom-control-input" id="xssScan" name="xssScan" checked>
								<label class="custom-control-label" for="xssScan"></label>
							</div>
							<br>
							<br>

							<div id="xss-options">
								{{#XSSPayloads}}
									<label><input type="checkbox" id="XSS_{{id}}" checked>&emsp;{{.}}</label>
								{{/XSSPayloads}}
								<input type="hidden" name="xssPayloads">
							</div>
						</div>

						<br>

						<div class="clearfix">
							<div class="float-left w-75">
								<button class="btn btn-primary btn-block float-left" type="button" data-toggle="collapse" data-target="#sql-injection-options">
									SQL Injection
								</button>
							</div>
							<div class="float-left">
								<button type="button" class="btn btn-dark btn-sm btn-floating float-left" style="margin-top: 5px; margin-left: 15px;" onclick="location.href='/sql_injection_help.html'">
									<i class="fas fa-question"></i>
								</button>
							</div>
							<div class="custom-control custom-checkbox float-right" style="margin-top: 5px;">
								<input type="checkbox" class="custom-control-input" id="sqlInjectionScan"  name="sqlInjectionScan" checked>
								<label class="custom-control-label" for="sqlInjectionScan"></label>
							</div>
							<br>
							<br>

							<div id="sql-injection-options">
								<ul>
									<li>Error-Based SQLi</li>
									{{#ErrorBased_SQLPayloads}}
									<label><input type="checkbox" checked id="ErrorBased_SQLi_{{id}}">&emsp;{{.}}</label><br>
									{{/ErrorBased_SQLPayloads}}
									<input type="hidden" name="errorBasedSqlInjectionPayloads">

									<li>Blind SQLi</li>
									{{#Blind_SQLPayloads}}
									<label><input type="checkbox" checked id="Blind_SQLi_{{id}}">&emsp;{{.}}</label><br>
									{{/Blind_SQLPayloads}}
									<input type="hidden" name="blindSqlInjectionPayloads">

									<li>Time-Based SQLi</li>
									{{#TimeBased_SQLPayloads}}
									<label><input type="checkbox" checked id="TimeBased_SQLi_{{id}}">&emsp;{{.}}</label><br>
									{{/TimeBased_SQLPayloads}}
									<input type="hidden" name="timeBasedInjectionPayloads">
								</ul>
							</div>
						</div>

						<br>

						<div class="clearfix">
							<div class="float-left w-75">
								<button class="btn btn-primary btn-block float-left" type="button" data-toggle="collapse" data-target="#csrf-options">
									CSRF
								</button>
							</div>
							<div class="float-left">
								<button type="button" class="btn btn-dark btn-sm btn-floating float-left" style="margin-top: 5px; margin-left: 15px;" onclick="location.href='/csrf_help.html'">
									<i class="fas fa-question"></i>
								</button>
							</div>
							<div class="custom-control custom-checkbox float-right" style="margin-top: 5px;">
								<input type="checkbox" class="custom-control-input" id="csrfScan" name="csrfScan" checked>
								<label class="custom-control-label" for="csrfScan"></label>
							</div>
							<br>
							<br>

							<div id="csrf-options">
								<p>No hay opciones disponibles para este ataque</p>
							</div>
						</div>

						<br>

						<div class="clearfix">

							<div class="float-left w-75">
								<button class="btn btn-primary btn-block float-left" type="button" data-toggle="collapse" data-target="#api-options">
									API exploration
								</button>
							</div>
							<div class="float-left">
								<button type="button" class="btn btn-dark btn-sm btn-floating float-left" style="margin-top: 5px; margin-left: 15px;" onclick="location.href='/api_help.html'">
									<i class="fas fa-question"></i>
								</button>
							</div>
							<div class="custom-control custom-checkbox float-right" style="margin-top: 5px;">
								<input type="checkbox" class="custom-control-input" id="apiExploration" name="apiExploration" checked>
								<label class="custom-control-label" for="apiExploration"></label>
							</div>
							<br>
							<br>
							<div id="api-options">
								<p>No hay opciones disponibles para este ataque</p>
							</div>
						</div>

						<div class="clearfix">

							<div class="float-left w-75">
								<button class="btn btn-primary btn-block float-left" type="button" data-toggle="collapse" data-target="#noSecureChannel-options">
									No Secure Channel
								</button>
							</div>
							<div class="float-left">
								<button type="button" class="btn btn-dark btn-sm btn-floating float-left" style="margin-top: 5px; margin-left: 15px;" onclick="location.href='/api_help.html'">
									<i class="fas fa-question"></i>
								</button>
							</div>
							<div class="custom-control custom-checkbox float-right" style="margin-top: 5px;">
								<input type="checkbox" class="custom-control-input" id="noSecureChannel" name="noSecureChannel" checked>
								<label class="custom-control-label" for="noSecureChannel"></label>
							</div>
							<br>
							<br>
							<div id="noSecureChannel-options">
								<p>No hay opciones disponibles para este ataque</p>
							</div>
						</div>

						<div class="clearfix">

							<div class="float-left w-75">
								<button class="btn btn-primary btn-block float-left" type="button" data-toggle="collapse" data-target="#improperErrorHandling-options">
									Improper Error Handling
								</button>
							</div>
							<div class="float-left">
								<button type="button" class="btn btn-dark btn-sm btn-floating float-left" style="margin-top: 5px; margin-left: 15px;" onclick="location.href='/api_help.html'">
									<i class="fas fa-question"></i>
								</button>
							</div>
							<div class="custom-control custom-checkbox float-right" style="margin-top: 5px;">
								<input type="checkbox" class="custom-control-input" id="improperErrorHandling" name="improperErrorHandling" checked>
								<label class="custom-control-label" for="improperErrorHandling"></label>
							</div>
							<br>
							<br>
							<div id="improperErrorHandling-options">
								<p>No hay opciones disponibles para este ataque</p>
							</div>
						</div>
					</div>
				</div>

				<div class="ml-5 float-left componentWrapper" style="background-color: white; border-color: black;">
					<div class="componentWrapper" style="border-color: blue;">
						<p class="componentTitle">Comprobaci칩n de requisitos</p>
						<div class="clearfix">
							Ruta local del proyecto: <input type="text" name="projectPath">

							<div class="float-left w-75">
								<button class="btn btn-primary btn-block float-left" type="button">
									All API methods
								</button>
							</div>
							<div class="float-left">
								<button type="button" class="btn btn-dark btn-sm btn-floating float-left" style="margin-top: 5px; margin-left: 15px;" onclick="location.href='/api_methods.html'">
									<i class="fas fa-question"></i>
								</button>
							</div>
							<div class="custom-control custom-checkbox float-right" style="margin-top: 5px;">
								<input type="checkbox" class="custom-control-input" id="apiMethods" name="apiMethods" checked>
								<label class="custom-control-label" for="apiMethods"></label>
							</div>
							<br>

							<div class="float-left w-75">
								<button class="btn btn-primary btn-block float-left" type="button">
									Possible template injection
								</button>
							</div>
							<div class="float-left">
								<button type="button" class="btn btn-dark btn-sm btn-floating float-left" style="margin-top: 5px; margin-left: 15px;" onclick="location.href='/template_injection.html'">
									<i class="fas fa-question"></i>
								</button>
							</div>
							<div class="custom-control custom-checkbox float-right" style="margin-top: 5px;">
								<input type="checkbox" class="custom-control-input" id="templateInjection" name="templateInjection" checked>
								<label class="custom-control-label" for="templateInjection"></label>
							</div>
							<br>

							<div class="float-left w-75">
								<button class="btn btn-primary btn-block float-left" type="button">
									Entity Relations
								</button>
							</div>
							<div class="float-left">
								<button type="button" class="btn btn-dark btn-sm btn-floating float-left" style="margin-top: 5px; margin-left: 15px;" onclick="location.href='/entity_relations.html'">
									<i class="fas fa-question"></i>
								</button>
							</div>
							<div class="custom-control custom-checkbox float-right" style="margin-top: 5px;">
								<input type="checkbox" class="custom-control-input" id="entityRelations" name="entityRelations" checked>
								<label class="custom-control-label" for="entityRelations"></label>
							</div>
							<br>
							<div class="float-left w-75">
								<button class="btn btn-primary btn-block float-left" type="button">
									DataBase communication
								</button>
							</div>
							<div class="float-left">
								<button type="button" class="btn btn-dark btn-sm btn-floating float-left" style="margin-top: 5px; margin-left: 15px;" onclick="location.href='/database_communication.html'">
									<i class="fas fa-question"></i>
								</button>
							</div>
							<div class="custom-control custom-checkbox float-right" style="margin-top: 5px;">
								<input type="checkbox" class="custom-control-input" id="databaseCommunication" name="databaseCommunication" checked>
								<label class="custom-control-label" for="databaseCommunication"></label>
							</div>
						</div>
					</div>
				</div>
				{{#_csrf}}
				<input type="hidden" name="{{parameterName}}" value="{{token}}"/>
				{{/_csrf}}
			</form>
		</section>

		<script>
		const canvas = document.getElementById("renderCanvas"); // Get the canvas element
		const engine = new BABYLON.Engine(canvas, true); // Generate the BABYLON 3D engine

		// Add your code here matching the playground format
		const createScene = function () {

			const scene = new BABYLON.Scene(engine);

			BABYLON.SceneLoader.LoadAssetContainer("./models/", "kitsune_rig_11.glb", scene, function (container) {
				// do something with the scene
				//console.log(scene.meshes)
				console.log(container)
				container.addAllToScene();
			});
			const camera = new BABYLON.ArcRotateCamera("camera", Math.PI/2, Math.PI / 2.5, 15, new BABYLON.Vector3(0, 2, 0)); // OK KITSUNE
<!--			const camera = new BABYLON.ArcRotateCamera("camera", -Math.PI / 2, Math.PI / 2.5, 15, new BABYLON.Vector3(0, 0, 0));--> // Front
			camera.attachControl(canvas, true);
			const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(1, 1, 0));

			return scene;
		};

		const scene = createScene(); //Call the createScene function

		scene.clearColor = new BABYLON.Color3(1.0, 1.0, 1.0);
		// Register a render loop to repeatedly render the scene
		engine.runRenderLoop(function () {
			scene.render();
		});

		// Watch for browser/canvas resize events
		window.addEventListener("resize", function () {
			engine.resize();
		});
	</script>

	</body>
</html>